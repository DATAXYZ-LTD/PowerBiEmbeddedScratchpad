<!DOCTYPE html>

<html lang="en" xmlns="http://www.w3.org/1999/xhtml">

<head>
  <meta charset="utf-8" />
  <title>Demo27: Custom Layouts</title>
  <link rel="icon" href="favicon.ico" type="image/x-icon" />
  <link href="css/app.css" rel="stylesheet" />
  <script src="scripts/jquery.js"></script>
  <script src="scripts/powerbi.js"></script>
</head>

<body>

  <div id="toolbar">
    <div class="radio-group">
      <span class="radio-group-label">Select Layout:</span>
      <input type="radio" name="layout" value="default" id="default" checked />
      <label for="default">Default Layout</label>
      <input type="radio" name="layout" value="mobile" id="mobile" />
      <label for="mobile">Mobile Layout</label>
      <input type="radio" name="layout" value="custom1" id="custom1" />
      <label for="custom1">Custom Layout 1</label>
      <input type="radio" name="layout" value="custom2" id="custom2" />
      <label for="custom2">Custom Layout 2</label>
    </div>
  </div>

  <div id="reportContainer" />

  <script>

    // data required for embedding Power BI report
    var embedReportId = "69ad0538-a1ab-4897-bb99-cd3baaa17833";
    var embedUrl = "https://app.powerbi.com/reportEmbed";
    var accessToken = "H4sIAAAAAAAEAB1Wx86Fao58l7tlJHIaqRfAIR3CgY_MjpxzpjXvPn_30lIt7LKrXP_-x0qefkryf_73H7K2Lztin8Fk2aqrzG0uZKXcSXlpXDV4Fv-DsgVdlWT5zovG5ZrN46UDqKjzHz3Dbl4loxh0rdqoy0CRhKifvIHsgK_VJYllojUAZ2GEcySGQfIROvKOi836Nd16HWWeQ2Lp933a2kjbj0CLovy1j-BEhsLMk9Me7JyULr0JjfUhUr5i3R6KOiA_mXhLerGiOHfJg4mqq6f0E93TgWDO1ozwR3fJaxOO_EkaQk7VHaX2QaZwTwoubp0c9eEYP6d6V-YR23nfHL8UYw7pGTVuWgsXNqeTdpJRQgr1jDJrdViH170rsqUAwZQE7MairkKpuKkhpclkoggAf-WKuzcBP147dyszsKUvHj0T1Neyzm6aq8PmGOFjV5Ul8M0TKIF8K6Q0wKuV0gpMN8UQhxgVfZiBv7oTngLxu3KFshKL5z0VxHCo5NEXtND8go6HOB7DD28tYxeuZ3pKmenYkLZm0eFiizPNBCC9D05JeN4kTHQaNbYkZGfwijDKBnsqFjrXW0Mgt3G8Lwloy3BJSTxHTmV_g3MUusNBdazMQzdGHlzEkKeq3FpocklDoABjftb3m-niWAzbHmes5aMMBiXz-tFMHhqe88yJSlszxhw2CkmXIhl_CECa8GB-CfZQ6GLLqzUe41mXL7QZSiGjgSnCY8h7Qv1FgvNXK43AmQ53-ITG2sAMffHFXokCDfmYqzsa0gOEL9PSTgkwx26wZ4l1o_9dynYmcQv8J5267EzBc76SoT-PZ5DsX7ks2JdVK61g7bdLHGVRKRIyJmLNKoKzme7cxj2dWWRfQjgbUIw04MmXGtrSRLsSDTjGnITAh_BT1O284OZAMN_l3AW-qEH0sPSk3M4pag7NYYwwXqGMCiM4YrsztL5UbEfG143hQvKe9_K-MueiM-TJJconh0LJKCfitAPfMJtHYbyjWrN7g1KixDUa7lhvc-0biILy_lQPsC6TL2mQeaQ-7hmuDTF8XVb4Of178kJ-kAyuBKs3hIJBTibtO97u3G2m4XdHv1IQW67p4Z9LBR1qU92CUvmzilLUHCZ3BjPgyRfc-bf84lKzTRz58c1yBNcoDsWnBZnwJ7Tv9zhYh-6-ZbrOtAa_52mF7NrTq-Sg2lANAnWpBF9xRCEsc5AU_DBNs8ku8hjA8FL7uAsC7EVFPvZVh8LjqmmZ3SoWo2MX-r5USDK6lNkLJ0jiJ8BV8OcKVqln1kg0tgo_mTlH3Myr9UtznLM_Hv_Lo5Hj7wSWFVq_t8jxb2RaoTwmPw46BbciVvfn9MYc7MtnP3cwSn5TVvmNAVc1fyYux6LzVeNY-x2B2kO6MjjDlDEwtrTdrRh-vhGIhQq0r7QUlkSFVTi6OwSdw0Rg7kvwGNi5Z9x2nUmB1Ik71E33O7DQ9zVWWljb40pnq37NF1WgyaHD59NIZZH_iBQpBoqXHU4kECorrk3ARPvQIbZnPgh7sBb36fJ3i60kS1X27sK_rjwVD6nntzWMxiVS20BveNuPME2Lx1JqxrBKFJLKtdQS93Qg_X2W5CBCdNXhnnqplWi-SGJ-bW_Px4Ib58A55yrQKdGTk08ZAPqEoiAdI0GO5g_c4IxpWaihda021IaHWoZ6m5bfLLZecypQJMtHILZRjnLh8oNrJmFWldCR0zahSKHRu1nUG_u-Iaos2CzmFRvp5TO1zmPxvYknT_QVysmwxr5AnTRKnAO3q0hjKTHakNx88ptYWP65IWPj2pQbi-ySky3LVJ0Z3ccg6hnEYXNiper1CbZLIpfKT-n1oJeWT17sfsaa4dX82OSlCnbn1m2MslQ-jF8W2XXudGiVdhsAKmwL2I6LzgC_XwcLjjl4DCkAYv6zER1BuHRtSRhTq3W_UMTDcqT7WOhKIH7ezoheVyffQku5uNChCtFpMV1hzdSZMSqDeIoKfwbX6HXJzLMcRLaq2HCHPReUJZjE9JQqiX-Oxi3rj7IvS6TRqb-hRncn5fEJCvPn49c2z48H4WdrMVRJdjdCepvSe413_1zJvNv-86Qmfd57BjEtSZkrZlJoeyFoGKCE96G_beL9GG-T-Yta8I596wCqYluLpprq31No-B9gTsM9-xRWkrzrKZ3RSMmqydA8_zTG6OiQUu4Yptk38uBwAFngjHwvoTAoMe2rMEDmuRieuQF7eAjQOyPCjS73YLVQSfJJZjDd9EzS_vMnFCCzfk1WMLmU34-BqSfDWOilZAPEeafwiRyhgoyCXj4xXOO9pVYg3ozLVkGUCmrUikEVCraRf8DVOD1P2Jcvznn0fZNdq-WgiOWN9DW1hmxJtJVGaYllj0XsGk80Qsyy69tFmOkaBOrQ203fDovuk3LvSqiHfpg1QRJIBGrFJjNyMn4A0INdm2DE13_-5x9hfeZ90ornL04VW7ZHjevXPN0K5onLsqpcwxcj_ibuVIohfDnw0JfZYCGa9JybXXvR8EO3IpIENHWyXr6GfSM5PYrBms_o885rgx1dOtf-MGmFwxp3LkjHzcaD6xYfnhmLZTyL5ZnO_456232w5W-U-o1BwepKzlf2t55ftF3H7VyatcGkudB_aqLB-dyvqCA3VSesFTA0HqSZJR28kTBm-iMFJgNHltiHhMBCmNl8367f39erHcjSWa3Bhq4rppFJV8Jj-PHz5nNolvX38Ue-c-ZG0pz0efwpNvk5kR3_6Mvi4HJgR-VI6wKtEaPoFsg3bfIQNbv2kZg3_56-QahNKiwYG3Se526Lal__-td_aH7mulhV_4_l29WYt1KhcVRy3u4DJrt20v4vymmqMdmPtfiDYfEnvMUGOAb1qb8nSOZDMB6hQEFZNaSj5MBDBCknR9bwbHcf8_aggNnGti0karVk_aYpkULils7ILaFi8wwzWXsdmUr5QXSHYUgVSdhZ8FBPMrYy-5UMxgLNK2xa600KOiRdq2Qfy_Z3mMjlRsahMDD-97V2fPqzPbJ7CA_zr6gZLvH6C6OMIaUNzVuti9VMcOdj4DfON_YxwSRfhU0OWtalUwBtHcT7tUgzrOB9Pc5yWipuHpStSIWJ2eqyRa3WoGwIPxmLZK3w9WG-F0ti2h2pMfXTR0ULi_n59X20n8OC2DD5R-jKl_TGNshx_gLLqZR-FNwZY2XJ-S3jyD8kb60l90fz__0_3uvGp0IMAAA=.eyJjbHVzdGVyVXJsIjoiaHR0cHM6Ly9XQUJJLVVTLUVBU1QyLUItUFJJTUFSWS1yZWRpcmVjdC5hbmFseXNpcy53aW5kb3dzLm5ldCIsImVtYmVkRmVhdHVyZXMiOnsibW9kZXJuRW1iZWQiOmZhbHNlfX0=";

    // Get models object to access enums for embed configuration
    var models = window['powerbi-client'].models;

    var pageName = "ReportSection432ffded90e56d5553a1";
    var mapVisualName = "a846946d789b47a1480c";
    var tableVisualName = "d0d0c86e46e75dc745b3";

    var widthBuffer = 12;
    var heightBuffer = 24;
    var toolbarHeight = $("#toolbar").height();
    var reportHeight = $(window).height() - (heightBuffer + toolbarHeight);
    var reportWidth = $(window).width() - widthBuffer;

    var defaultSetting = {
      layoutType: models.LayoutType.Master,
      panes: { filters: { visible: false } }
    };

    var mobileSetting = {
      layoutType: models.LayoutType.MobilePortrait,
      panes: { filters: { visible: false } }
    };

    var customLayout1Settings = {
      layoutType: models.LayoutType.Custom,
      panes: { filters: { visible: false } },
      customLayout: {
        pageSize: {
          type: models.PageSizeType.Custom,
          width: reportWidth,
          height: reportHeight
        },
        displayOption: models.DisplayOption.FitToPage,
        pagesLayout: {
          [pageName]: {
            visualsLayout: {
              [mapVisualName]: { x: 0, y: 0, width: reportWidth, height: reportHeight },
              [tableVisualName]: { displayState: { mode: models.VisualContainerDisplayMode.Hidden } }
            }
          }
        }
      }
    };

    var customLayout2Settings = {
      layoutType: models.LayoutType.Custom,
      panes: { filters: { visible: false } },
      customLayout: {
        pageSize: {
          type: models.PageSizeType.Custom,
          width: reportWidth,
          height: reportHeight
        },
        displayOption: models.DisplayOption.FitToPage,
        pagesLayout: {
          [pageName]: {
            visualsLayout: {
              [mapVisualName]: { x: (reportWidth * 0.20), y: 0, width: (reportWidth * 0.80), height: reportHeight },
              [tableVisualName]: {
                x: 0, y: 0, width: (reportWidth * 0.20), height: reportHeight,
                displayState: { mode: models.VisualContainerDisplayMode.Visible }
              }
            }
          }
        }
      }
    };

    var config = {
      type: 'report',
      id: embedReportId,
      embedUrl: embedUrl,
      accessToken: accessToken,
      tokenType: models.TokenType.Embed,
      settings: { panes: { filters: { visible: false } } }
    };

    // Get a reference to the embedded report HTML element
    var reportContainer = document.getElementById('reportContainer');

    // Embed the report and display it within the div container.
    var report = powerbi.embed(reportContainer, config);

    $(":radio").change((eventArgs) => {
      var selectedLayout = $('input[name="layout"]:checked').val();
      var settings;
      switch (selectedLayout) {
        case "default":
          settings = defaultSetting;
          break;
        case "mobile":
          settings = mobileSetting;
          break;
        case "custom1":
          settings = customLayout1Settings;
          break;
        case "custom2":
          settings = customLayout2Settings;
          break;
      }
      powerbi.reset(reportContainer);
      config.settings = settings;
      report = powerbi.embed(reportContainer, config);
    });

    $(function () {
      var widthBuffer = 12;
      var heightBuffer = 24;
      var toolbarHeight = $("#toolbar").height();
      $("#reportContainer").height($(window).height() - (heightBuffer + toolbarHeight));
      $("#reportContainer").width($(window).width() - widthBuffer);
      $(window).resize(function () {
        var toolbarHeight = $("#toolbar").height();
        $("#reportContainer").height($(window).height() - (heightBuffer + toolbarHeight));
        $("#reportContainer").width($(window).width() - widthBuffer);
      });
    });

  </script>

</body>
</html>