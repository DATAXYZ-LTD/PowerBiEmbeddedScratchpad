<!DOCTYPE html>

<html lang="en" xmlns="http://www.w3.org/1999/xhtml">

<head>
  <meta charset="utf-8" />
  <title>Demo07: Report Toolbar</title>
  <link rel="icon" href="favicon.ico" type="image/x-icon" />
  <link href="css/app.css" rel="stylesheet" />
  <script src="scripts/jquery.js"></script>
  <script src="scripts/powerbi.min.js"></script>
</head>

<body style="margin:0;padding:0;background-color:#EEE;">

  <div id="toolbar">
    <button type="button" id="filters" style="font-size:14px">Filters</button>
    <button type="button" id="bookmarks" style="font-size:14px">Bookmarks</button>
    <button type="button" id="toggleEdit" style="font-size:14px">Toggle Edit Mode</button>
    <button type="button" id="actionBar" style="font-size:14px">Action Bar</button>
    <button type="button" id="fullScreen" style="font-size:14px">Full Screen</button>
    <button type="button" id="print" style="font-size:14px">Print</button>
  </div>

  <div id="reportContainer" />

  <script>

    // data required for embedding Power BI report
    var embedReportId = "69ad0538-a1ab-4897-bb99-cd3baaa17833";
    var embedUrl = "https://app.powerbi.com/reportEmbed";
    var accessToken = "H4sIAAAAAAAEACWUx66DVgBE_-VtiQQYLiVSFqYX07t3YC7V9E6Uf8-Lsj-axdHM_P1jp9d3SPOfP3-4ZJE-DOMbr2DemRvjjmutAqF3JTm0kT3OwFUXN8d70e4UEGU44rOzSOLsDXhzYba3q7_Y6r56vjac4sIr6maNikpHGoaywQSV77HoDqAsj0zdITv9pza_ei8vtY-guo12Kac7Yb7cl52HMrQhemGQdOM9JMQugmZ-lsG58J_oSqxLiPkUPOBVW5pk-8XTwkChSuDDK5Df6ak7FUz0yPOp3mcQoHgi5lgZPAVJ9LriNN4cWpCEeORPgAXy1otV7sk4jUq8U42V3SSO1kRaLosPJtbetUg3feelQYYW1nuDy5eLJ_zCXa-ZBqT7rsaofAH20A8qCyUiuMxorvq796Fe6OmNwaFxxUtVCy5AbUcOd_GGsZofa6RO2jHp27n5gPE62bNnCrfIlPdNcCwtP--ToI8Cu6oU5U4ul36DFyEaBWHS3RR7XRfhno54cqJHKUXUwFji5ItZ3DHtFw1NNnsO_Qbmimmzvp2r4GvGUp5LciUsH_eqonzREP6k9W2r5N5CH8S4to8pkbkgtd8VyxZNhHRiPTPaLR2UoD6KdauhhnYBlVToMlyjPYudHeZMkHtVoyK7pPcvfxW6XJVZQBk8yJ5KhghtIyoFaZrUDlWpBT2Ax0LCJD6rQs_kEb_spLnZb1keF3-Nnj6XY1UHPIk2hBDJo5bo4YuqiYJZmH7o3kKxObrvP3FBVAP8dPSB-QwF9d2ggXYjOmafiRsPhDIpjdELA1IF0YkmDnh6krd0FCJFQuoV16yx1By1fxMlUbIrLjazdm543n_KpaH7SCAXC3mg8FUnJexfZIw82iMCvL51JWzra5v8kLOiqr4gF22kYfHaJaTWbmxvtAzVlBtPKvFb2iyRokGngo3FlRax9WQXRCD2hvV1_gvi54Zk2NvkPz9__PDzNa6DDq_fOfYukzQ5sLtm4hjL15v4rYVWzfO457yyR1n6fOAD0LVYjzg-uTRSrdQ6qF4WsCQEr6x9yYWiJYC0BuFWPZJHZl0jkQkQfkuqRvYxQZi-8be9RYkoS427n1Bc4bBJ3_Ulct-cXRwI7jHWb5Z78-dKa2StMdtm3uQ8MKFcTOUx4Ga839EiAWCN1GxTn3IENtnGEvbesU_kKdbg3FJW-j75YjqJ5ks6LqbBPNMMt21HWj92ReKsRmBQN5hqBDwMSLZw5M8I1FdiF6cpTBZgBGzUFI8MntwhhK52_H4USon27UdNF7_ady5rciYm08Gvjrzl49hHLpm92QRQ4nYnOpf25UN5_vXXf5qvsYKzGv5adpEdiNjJZJiLVCvma_HJ9v9TXl326brN8BcTxppY-Kdce3wg-xB9lOtQ3rMnMTGIoo01-54q5xwD2GrKSvoREft5Jg1utVyUGeR-8Wx0FblB606e52px6kIe2XyQu7lKyhDp727ES_o0z9vRf9_vXLJ3DSGhP-PKOqh7yV9HqvQSg49hJOpWVq6s1vIXI7GyIm-EdvvYKMB1Oxfme4LEjhQeIdHqSVQ7uYgfklrOrGDwAJRfZ0F3WiiijTv5Ks3b8JSq52h0HkOiH6MP--5rwtMO7q--b8Py0nQk8B2BWR5XZRd-BFECUswyISRGcfSWtuUYuXXqj-khxWnkbjuFl6jLwNn3PSvsUh0YBf7bj8sg86_7Et5aEldvmSl_Nf_zL91aMM2CBgAA.eyJjbHVzdGVyVXJsIjoiaHR0cHM6Ly9XQUJJLVVTLUVBU1QyLUItUFJJTUFSWS1yZWRpcmVjdC5hbmFseXNpcy53aW5kb3dzLm5ldCIsImVtYmVkRmVhdHVyZXMiOnsibW9kZXJuRW1iZWQiOmZhbHNlfX0=";

    // Get models object to access enums for embed configuration
    var models = window['powerbi-client'].models;

    var config = {
      type: 'report',
      id: embedReportId,
      embedUrl: embedUrl,
      accessToken: accessToken,
      tokenType: models.TokenType.Embed,
      permissions: models.Permissions.All,
      viewMode: models.ViewMode.View,
      settings: {
        bars: {
          actionBar: { visible: true }
        },
        panes: {
          filters: { visible: true, expanded: false },
          bookmarks: { visible: false },
          visualizations: { visible: true, expanded: true },
          fields: { visible: true, expanded: true },
          selection: { visible: false },
          syncSlicers: { visible: false }
        }
      }
    };

    // Get a reference to the embedded report HTML element
    var reportContainer = document.getElementById('reportContainer');

    // Embed the report and display it within the div container.
    var report = powerbi.embed(reportContainer, config);

    // Display Report object in browser console window
    console.log(report);

    // toggle filters pane
    var showFiltersPane = false;
    $("#filters").click(function () {
      showFiltersPane = !showFiltersPane;
      var settings = {
        panes: { filters: { visible: showFiltersPane, expanded: true } }
      };
      report.updateSettings(settings);
    });

    // toggle bookmark pane
    var showBookmarksPane = false;
    $("#bookmarks").click(function () {
      console.log("bookmarks", showBookmarksPane);
      showBookmarksPane = !showBookmarksPane;
      var settings = {
        panes: { bookmarks: { visible: showBookmarksPane } }
      };
      report.updateSettings(settings);
    });

    // toggle report between display mode and edit mode
    var viewMode = "view";
    $("#toggleEdit").click(function () {
      viewMode = (viewMode == "view") ? "edit" : "view";
      report.switchMode(viewMode);
      if (viewMode == "edit") {
        var settings = {
          panes: { filters: { visible: true} }
        };
        report.updateSettings(settings);
      }

    });

    // toggle action bar - report must be in edit mode
    var showActionBar= true;
    $("#actionBar").click(function () {
      showActionBar = !showActionBar;
      var settings = {
        bars: { actionBar: { visible: showActionBar } }
      };
      report.updateSettings(settings);
    });

    // command handler to enter full screen mode
    $("#fullScreen").click(function () {
      report.fullscreen();
    });

    // command handler to print report
    $("#print").click(function () {
      report.print();
    });

    $(function () {
      var widthBuffer = 12;
      var heightBuffer = 24;
      var toolbarHeight = $("#toolbar").height();
      $("#reportContainer").height($(window).height() - (heightBuffer + toolbarHeight));
      $("#reportContainer").width($(window).width() - widthBuffer);
      $(window).resize(function () {
        var toolbarHeight = $("#toolbar").height();
        $("#reportContainer").height($(window).height() - (heightBuffer + toolbarHeight));
        $("#reportContainer").width($(window).width() - widthBuffer);
      });
    });

  </script>

</body>
</html>