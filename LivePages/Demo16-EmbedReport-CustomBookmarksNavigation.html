<!DOCTYPE html>
<html lang="en" xmlns="http://www.w3.org/1999/xhtml">
<head>
  <meta charset="utf-8" />
  <title>Demo16: Bookmarks</title>
  <link rel="icon" href="favicon.ico" type="image/x-icon" />
  <link href="css/app.css" rel="stylesheet" />
  <script src="scripts/jquery.js"></script>
  <script src="scripts/powerbi.js"></script>
</head>
<body style="margin:0;padding:0;background-color:#EEE;">

  <div id="leftnav" style="float:left; width:240px;">
    <h3>Bookmarks</h3>
    <div id="loading">
      <img title="Loading..." src="css/img/loading.gif" style="width:80px;margin-top:36px;margin-left:72px;" />
    </div>
    <div id="leftnav-menu">
      <ul id="page-navigation"></ul>
    </div>
  </div>

  <div id="embedContainer" style="margin-left: 260px;" />

  <script>

    // data required for embedding Power BI report
    var embedReportId = "69ad0538-a1ab-4897-bb99-cd3baaa17833";
    var embedUrl = "https://app.powerbi.com/reportEmbed";
    var accessToken = "H4sIAAAAAAAEAB2Wxc7FXI5F3-WfpqQwlVSDMDNnFr5hxla_e3_Vc-vI3mfJy__zj529w5yV__z7H_FW2UgbtOtQHzhZ1vm7F6wlhC9F1bpZUK1CclNPsl9ch48Besqu6OA7udri_FzXayaUTq_6WlnMIwfKxU286dDXLmDbQqCgfqrl7c57IdzY9ThJzM8SKCMNecBDFnPrKdQWaWNXwWNgKDg4uBf3Vn-oZ9eDoUI6SEwmlYwbRZ1P95MowHpNT66C2P8scrNLQb8vDTXZBAGSCts0j0_7N9xlMvORHAFYVYwl1urbH4iseOpmRYTxSb1BP3QJYTsmj28ekyOBUJA1-P7Uiqxyfj2_tIhdl4Vk11gr1GzbuqYQXt1RHlWmHaMJCnLp9FqWWBuGvoTWccMuublIMtbecy6dSoe8RzJ7awz2cUxrOzR3PkSa6N9csvHMr5LaEWpgZ8oz6B5RDLb6At2y-aV3M65z4bUqQ99LRAhcl8gnNaB3apTkyRl6EByBVwHYjjsgOBPgRDQMussPLoEXjdu93L2lQqPe0z1MfGQ0BXLDFe03u5Z5uqc4DTU-ql423s2ih4TBJVRwu6-gnAy_WR0XNRk9fPNGqxw1Hds1zjhwd-6awg2u_dj0GcpX3Rro6WsgrIGfW3kSIOdF-S4F8LE-YoFbZIOJ6rSQaB073rRHXkLUgMJDp1Ac0S_wQegAQurrslqf-DsnK6GQEPxj6sMN3nlovLEW4vfhgd0lTsWTa-m1jSqOkcZIY2Tw16t271GlNwiKsNu84j0gSvgkdX1ySQ1fbmpZlszstE7kM0VMrq1b5Jspd_jqnuWfSWVFM86J3lAOI29qdHC9NfQUV13qFXZE-gBfy-DmPzjPmf1WCZ6K4LX7lAe7fyeVqC8WKMNRgbN_BDMWUa9IrKpDUtf0vrq7ONrsBtw5H0UWsDjOTdB6RBu4MvKi35N8gWnezUOYPMGDIHF3m7mU2tHoZhq4-kr9nX2Y_VYBPx_eR8cuHfFk1ISGuweaVUYUhdYY5jPMlLR7nQq9Wd84J1K_g-awkEGC_GHjWHHYGxej3hCAl4WcjlwP0Oh0u-2mj2fQkEo8w5XcykvBKGcZhS0Tv5cWx0BqJSA8Wt0wP__uX9DNYdUGElLOKqUwNIACJ6W0jXOMEQOMZ2rX_jRiMV6ePmBhs3wp3tmoq6NocMQIzV_7WLLdT9BrMbXNNFz5YyuDvg_3b5DS8Ew-4Z2tckPzrlFURh_ijaNYqzAvmZxrY5QZPOFZXc8TJQuu2fYBxwpOHNdWBRw4dK6qibysdxwQKLtRShnXSDyms0laGTSbT2W287U_6dUk2NFaI6kytQKDeZ3PQHxuU9IJh4rqTc9rKyQfX4pJCFAetqBDM77c4lQVEHtH8S5LFrYM8BquvXyEBNh7Y7iiDGh5bHW44pXERMrREMdFQIdNFQVeoQzn7tOA3GUkZeW7llXd2UCvPd0ZUbBX4-0fKwPHS2jcIb5e5HXUuyeF_u6URiJ5I_iskP7wkLnqCL2Qh-kgJL7C71N-PR3rznQf0DLI4ULopMgEwJLsRkixr_92-KK_zwQLVoxt-kZJAxwCQxnhr3gpwHLaS59C0BRQbyGQjg7R7gsGIlwBTY6Q5Ax0q0JpimNNUq7INZUJtk0CPBCdK6nlfI8h9ZOcSBUdrNtgEW4BP3zQB8FmpXud63z1q-pD6MZLo3dHrPNmBjIbLZPu6IAbjVT4lXAYyrklPIG5Mt6WyDbYhcz8Q_7-ZABQOI5tKBKll7lYqCmE7RFRL9LfVcJt8Vn1-45Q8-kzdxEO9DRYs_COs0AdSVwJCqG5w_nqkFMmTbWoIRhVKBF0xwi3MgmAF7KtHXmyrNUXmrYfa820n4wvz_bHvG0sYJ1uhIb86iuKfNvf2aNqrmZ_543X1V4JM6Bpz2A2XJcFzVfclRvJLZelL4-CiwB9EksvcJ72UiC6g8z0rPC5kdGYkZQ7Wl-2uxSncYCr0Ysv0pk0Gyd3-NnUecAlxr_NdbxEr5zhvn4T6sWNpSIUGrw4CYBdSt51bsDnhXtpN0Jrc-2hgPaRzmS10IGd15CnAegadn_fsag4Hxn1XPmfPn-qzn6pDFBgCwEZYeK29NlbW_15H3yyVNZqbUZfQ0YPG-zxHhv9jPaRxvrBgeYwMrceCt9TfvB4OjUDEIU051G1dRdMZpSlq-jRJvT3dp5iRf6jiX4dKxZ9cArhn3FGJciZdtpaoihow15Wfq7vG5oaEkZLrAZF9XnjJ10lQaOif5La_42y71GdDwL8HngbigTOkRYfOQSt8ylB5ZG7zWR3StC1ByN-hp2PpPIfXaMf6vyqMUILOSYm35JPLAR16fNv0fYqESTK2FaBrIhDvPYOupchs38X2a3Q24G6srt1WB1d7e88r-RQkikjdIBwFXCmLEQ-uQ6ncyxPNuIiVTLYuwz__OsfbnuXY9aq9--cWtp1EuxRuIsnC4SdzqEqbAELIfTirz1-Po33I8DuePs9FrMoLyUJ1r0bGIAMtiUbrnur_WliONuIq57AOnA0O1XJAn8FVPAlwYKW-XLBrdUWnRDg3oVo-wevGelOxX14B94Pw2wFdvfL5Z7pd80m0J7o38oT_pQqO_wbZyv7WQ1rV1FiUQpiJQmzN6wCn_JbN7zDOS2GKsijuql7_-l4es6eaeOypB1KlwCYHZflZOUzkQBD6RB-4zekHjPUKtYssoFaDLmfEjSWUmrfbR9gi74_VJhNUYF_mNaqClb_6gl_Cv3NztFuJPU5pGoifxPjMWoaO_l8_wRv3N8UXAm0ClmJ-c9__hvzu_yqTQn_Uq7Z03mz-Ly6kNXRcSx04zud_6_6OxSm7Di36q8MNsMBDeFStndWhstO9CbEuAX6tC9mbkzyA2pP7spkHgKsmUVUo_n2HYitbURC6WKbEQh43G8hWA0sHUgbB0k1k9VbIqJuUbNQOPQaTnH8EMeBp1tLoDh_-9OfuJffo34B1-xbwngB80A_8e7vPLENToNm9vqTh4ejHlQXLd_owOvNVqbTGDpJTF4lNe9Q0Rnr6JWJmN0BBQ2mmyThQt20VJuZ6_XpTMwQhGN8USVHFibN636L8B9xAWZcjZ59FJydzZwUtyJHiwCmlcOlCanXXxhQ0hezSoRcajW8TMl1N8Ji7JqLXPR9wcHGRja5nnJNRt5lWmznolp9thf4DiJUwX9j_t__A1IPpdBCDAAA.eyJjbHVzdGVyVXJsIjoiaHR0cHM6Ly9XQUJJLVVTLUVBU1QyLUItUFJJTUFSWS1yZWRpcmVjdC5hbmFseXNpcy53aW5kb3dzLm5ldCIsImVtYmVkRmVhdHVyZXMiOnsibW9kZXJuRW1iZWQiOmZhbHNlfX0=";

    // Get models object to access enums for embed configuration
    var models = window['powerbi-client'].models;

    var config = {
      type: 'report',
      id: embedReportId,
      embedUrl: embedUrl,
      accessToken: accessToken,
      tokenType: models.TokenType.Embed,
      settings: {
        panes: {
          filters: { visible: false },
          pageNavigation: { visible: false }
        }
      }
    };

    var embedContainer = document.getElementById('embedContainer');

    var report = powerbi.embed(embedContainer, config);

    report.on('loaded', async function () {
      console.log(report.bookmarksManager);
      $("#loading").show();
      var bookmarks = await report.bookmarksManager.getBookmarks();
      $("#loading").hide();

      // display bookmarks in browser console
      console.log("Bookmarks", bookmarks)

      var pageNavigation = $("#page-navigation").empty();

      for (var index = 0; index < bookmarks.length; index++) {
        // get name for each book mark
        var bookmarkDisplayName = bookmarks[index].displayName;
        // use jQuery create a navigation link for each page
        pageNavigation.append($("<li>")
          .append($('<a href="javascript:void(0);" >')
            .text(bookmarks[index].displayName))
          .click(function (domEvent) {
            // get text from link to get bookmark display name
            var bookmarkDisplayName = domEvent.target.textContent ? domEvent.target.textContent : domEvent.target.firstChild.textContent;
            // get target bookmark from bookmarks collection
            var targetBookmark = bookmarks.find(function (bookmark) { return bookmark.displayName === bookmarkDisplayName; });
            // apply bookmakr to report
            report.bookmarksManager.apply(targetBookmark.name);
          }));
      }


      report.on("bookmarkApplied", (event) => {
        console.log("Bookmark Applied", event.detail.bookmarkName);
      });

    });


    $(function () {
      var widthBuffer = 272;
      var heightBuffer = 18;
      $("#embedContainer").width($(window).width() - widthBuffer);
      $("#embedContainer").height($(window).height() - heightBuffer);
      $("#leftnav").height($(window).height() - heightBuffer);
      $(window).resize(function () {
        $("#embedContainer").width($(window).width() - widthBuffer);
        $("#embedContainer").height($(window).height() - (heightBuffer));
        $("#leftnav").height($(window).height() - heightBuffer);
      });

    });

  </script>
</body>
</html>