<!DOCTYPE html>

<html lang="en" xmlns="http://www.w3.org/1999/xhtml">

<head>
  <meta charset="utf-8" />
  <title>Demo05: QnA Experience</title>
  <link rel="icon" href="favicon.ico" type="image/x-icon" />
  <link href="css/app.css" rel="stylesheet" />
  <script src="scripts/jquery.js"></script>
  <script src="scripts/powerbi.js"></script>
</head>

<body style="margin:0;padding:0;background-color:#EEE;">

  <div id="embedContainer" />

  <script>

    // Get data required for embedding
    var datasetId = "ca6c991b-5bf1-4fa0-9aed-73d51680a82d";
    var embedUrl = "https://app.powerbi.com/qnaEmbed";
    var accessToken = "H4sIAAAAAAAEACVWxQ7sCBL7l3fNSmFaaQ7BDjPfkg4z02j_fVszd6vALrn89x8rffopzf_89w-zxmuAlmAvC10zJtgeFiLzCpqQsRwDIucn8f17fhI7qOidUBZp5TFTfdE4JVV-yPXT5ErjOqZhQI5BQYh6bTirb_Vlnjrne42rugYSICbjsn6m98ziHsT1-Atybe5xpHOBdGHlSGANT6VeKR4O8tt_UI6bnRGoFYvbR-0uU_uM12J9rXCcKjO-E_fq7y0m-jCmDmjzXbnwWdSsSs5v5t3cQv0aT5Ixaby3Hbk5jQ3jtCiww9ChjNAW65XX1kVyaUAhhcLTXHZRhx53qIKQvMKUJpjXyq2r7qMb7GOasMEojxyh4KE-Ekbp9dqEtIliSDulcIEfTaLnXSek7lXbUYHdWQitYMjRvC4EKeFXleppOuAQ5jMOIDotu2ARK2hbhrIV8es8NPfjFgWFAgqLSgQ-lUtihgGrlvhqyCFvC1rClh6_UzKkSBLMlkrAaWmKIgs1ojh2WwrgyfeKrSiIN-wsTiSvTp3ly2nooyFkkNKgUVq0tga2ZL7tH0_Sup1zPNp3MRHq-rA-OzhWyWCnydqIlnYP3yNwzMw1_QuT8k51eBhnWrGNf5pg65svEQZCZxywABKz483cb3I37Ekkr7_eyR3CRC2sRZx4ym-8L_dqVSmZOsEpz_1amDk_9MD1Ip5Vly1IWGiWCzXI09U_qksAyQkvKIbN5Qa_qpCsqXfNbr5fC7OI3jZG3lvA71NSY8lna6z4n44QJX_3G52KxbVQn2z-hmuw77guhR_GvfgQvpo5O0Xghg3_mE90nNfM_Ji_LWd9pbhAXETihOcn2kJ7qgTGr8da3nbEoEkrdTFQska39hli0WxTgiu7wC6Pe0pfMg0QaO0IRGzVjMJsYUNER7twPq2vt3Ipyhd3P8GzxeVQQGD5luoY0c3gNyQt0jLjKzGthvrMLgnPcGarsE1Zi27we9SOZdPqHp6TTOqdX3NvbL0QSpjKCpo-rZJ8gaGMNY7CNKy3ODi-N7t1RqbyARD4XBo84p0UWS9bQWwAYB0oj26I8zK0ioHuoodUANVUsxTGW97jCWCNYk8u03AYlkXHsCFX41DLEzHE3GarEV4WeAUBSvFiAZUs2dlWRb7Aulwp5Jwzw7HwkD53XvIC5-ah7fCz0LyzYz8BRQ4Bp2FCB7ShUjW-xum7xgSRLhIlYjRDzVq0y1KYkVmvi5c8DLl9cl7c7FfxcJp385Ch4yKjgVtTx4U8fqf5KxswR4jU-h51ApC6b45UwH9E_GLbwRpHh_YREe4AnoNsOcqbvSUMANHuio1RAUvsm2SjsGoijS9DT2xwXLpQOQ_qx7TDp8ilCQXyV89PV7uqwu8SI9yeGDRLkg4nbRpB--gDoMdub8TNhBFr0_l0kq1MKzxUsQNM5_L5ZMXu1g0xf8qVgST6ub7YPYpBvW48brgL_pQQfjP1d4vlRcFPO1gcrNAuTWr81lL8inbibxqgF-lQXfgmXLiMMXMFVGTQctEzz6VnH-yFxvs7swFCGHTX6hWwm5XCeKaFtDzC1DLNWubiT8ZXtPK2vQMDBazEy-SPYHngZilgKIaA18cXMmhhniJy1NC2vaJv967K-2BP9014bhZW7Zz5Qgt4D1CWPMhAuO2gYD_Ag2lvJG_4eRuyl9aIXQQ9t_RaVbR6-yl1EeIcXzAjxUXmre571toUfr-jwVUeuNSKroK9shdRJsJIQdLMgJlJ-qOPRZa2jyIj55XClyndVfxywWUyL6PN2EpuU3sY_VHpzq9zsVzV_vVEfq9e0eVzWZwAGYSMNkZWqduVj6WMdekOLaB2yuk9aTBl_ntth-qrxzal2qMEamnD-Bau883nWI5wqiTNu2OjmSlf-EK5u375n_dh31542kqzcfI2565QFk7ITaR8Y2C1Em2anbIW33Du7sIncOZrpuPqPK2QCbX3khxu0pRtqd0-e0GBfJKy4QJA6VpxFac4q-RwNg4Dr3yJxEMeuc2vzOrynF8j1PvN1IaKO1heHCR7GIeIuhnFGPtXMGiNb2sqRFu9E92DV4euwZ085LXrTNHRqibR5N1Sv0e0i-_LZUf9Qgz-KMbsLpPDfDS1odz5SCHxySPNG-eEjaZVf0fHBOXC14Krbx-l1PZ85VHfmoGEbhXCn9V6BJyK-Htv188hIe9hGSy1NHgBqB_NKWBmOOCDykeeE4mROnoXBqCb4lqzT0H5qBbg_EagVv-8tznxvW5vfWqtYv4mB6JWuUypYrZAQDs7Z0F_vQyZOFo_wVJ-zSVGw1rOZvv-9KhHxanr9_MJM5jcnst61icysijl9CUGycjv_vAMPkyy3OkmIiP1CegGfe78ApBJw3yulSJ7jVbAHXna82P7r7_-_OcPtz7zPqnF84tJsmrTX0v2cuMkf1o_HqsISML6cbz5FfaRDCvXfCilqxUXf1HInnBeAZv1m_h4h-5wWufofXpFKCKeMHv87KeIN4IMhbfkgJ7XMPPuh-dj0147XjajZB804-lCqQQZGn-LwM-Q1bf4YygiSoFQZVcdRgxpxKCML9YIL1ptlzmHxM4XQDugCJclPiGvTOA9pMngeKCbH7czLay4cMD043DmcoplvE7r3OBieuwVuhwHYHvvae9nDA-8U2Za7ypOeA_ACHgFHExfomaq1TidJ_RB35FA1oFsU7isG0wFRzmQS76ibjHdZEGzEYUG5Bx70ORYsPicMXTRuUtLfGZkqyQBxD_VvzQ_c12scvBj2WZApy3WUuLl2ELp3tBUK7n-QblNNab7sRY_mHnophg69JIYXUYMy-aDRwtMA8Jv_JZkcNtbo2eHe9FM-VOnwDXosZ-iVFvhZXS1TiuJKWHAwRzbnrkflkRJoTtEvjlcpqXrBqIswpFABQF9ChYqBFFVVL4fGDcEfu4DQx8tiC9ACpUcjDHMUQ_69YgcJVJPnXYn3G9JDzQjfbOMuZFHCmBLnWCaRH2boTctrcDpfRUhjLgLhyxu8XWvVTr1EVc9vmeeE1L8aH3pWX6B41T22ULWD9QdrmWpsRUu1uzyD9WZ3rC5mjj-TP3yf09kHmzOnIOvtadFjBLHyLFzOqnYIiDuRPaM1Fj4a6LvAI06NZHS5LZVRCTp_eV4_p5q5kfz__4Pml5zhRoMAAA=.eyJjbHVzdGVyVXJsIjoiaHR0cHM6Ly9XQUJJLVVTLUVBU1QyLUItUFJJTUFSWS1yZWRpcmVjdC5hbmFseXNpcy53aW5kb3dzLm5ldCIsImVtYmVkRmVhdHVyZXMiOnsibW9kZXJuRW1iZWQiOmZhbHNlfX0=";

    // Get models object to access enums for embed configuration
    var models = window['powerbi-client'].models;

    var config = {
      type: 'qna',
      tokenType: models.TokenType.Embed,
      accessToken: accessToken,
      embedUrl: embedUrl ,
      datasetIds: [ datasetId ],
      viewMode: models.QnaMode.Interactive
      //,  question: "What is sales revenue by category and year as clustered column chart"
    };

    console.log(config);


    // Get a reference to the embedded report HTML element
    var embedContainer = document.getElementById('embedContainer');

    // Embed the report and display it within the div container.
    var embeddedObject = powerbi.embed(embedContainer, config);
    

    $(function () {
      var widthBuffer = 12;
      var heightBuffer = 24;
      $("#embedContainer").height($(window).height() - (heightBuffer));
      $("#embedContainer").width($(window).width() - widthBuffer);
      $(window).resize(function () {
        $("#embedContainer").height($(window).height() - (heightBuffer));
        $("#embedContainer").width($(window).width() - widthBuffer);
      });
    });

  </script>

</body>
</html>