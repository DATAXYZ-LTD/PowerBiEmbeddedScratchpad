<!DOCTYPE html>

<html lang="en" xmlns="http://www.w3.org/1999/xhtml">

<head>
  <meta charset="utf-8" />
  <title>Demo21: White Label Loading</title>
  <link rel="icon" href="favicon.ico" type="image/x-icon" />
  <link href="css/app.css" rel="stylesheet" />
  <script src="scripts/jquery.js"></script>
  <script src="scripts/powerbi.js"></script>
</head>

<body>

  <div id="loading" style="text-align:center;">
    <div style="font-size:52px;margin:32px;">Loading report...</div>
    <div>
      <img title="Loading..." src="css/img/loading3.gif" style="width:25%;margin:0;" />
    </div>
  </div>

  <div id="embedContainer" style="display:none;" />

  <script>

    // data required for embedding Power BI report
    var embedReportId = "69ad0538-a1ab-4897-bb99-cd3baaa17833";
    var embedUrl = "https://app.powerbi.com/reportEmbed";
    var accessToken = "H4sIAAAAAAAEAB2WxQ7sWBqD3-Vu01KYWupFmKnC2YWZkwqM5t2nerZH_-ZYtj__54-dPsOcFn_-_oM8DlQVjBOT0wzlsNGQrBt4BGtIM3a6H3abXBlIkfztaPXaxTQ9gdS6MGJWINXmX1UJRNKdg_I4VqwZGPEtH501TG-TDqD1QP1rLFMK4K6q0gtEgnJziULeOeARZBl6EWS_rD35yX3ekbD-Rp9UNj1ttshcHISRibE3fwrmTKigtwQRjeviDMDo_laFINXHfAkNXEQK5-21tBeF3xR3xjqMjSkHBzN49DIWsJtp9wFs9py6Bu3PteJz6cGQFJV4F4Cu4dEE-G6rY0KLcnhADhzqlHse3W5T5W72RgAnaJSbVdkY9muxyglvR6cbBWUzTXn1bTE8kEpLqX3HC9LPfsxpRXc26vlowHG9H0yQdwPYjGK1J8SPa8Ij7SUx4BgeIoq0TOCml4kBF1uw0c7Sw49qxC62R0oeem25fj1cH7WNHswbf5Q7YEU8G_N8cO8U3plGoq34acJwjx9KCoB762tjcu7wDZ3nbJC6M6rMaTvs6TCSQhmqx1viRSUl_Ti--GzvkBmzEvDakri9F6uxTlVyn6t4iNEy2C7zBiFtWlqYw7GCcyL8peTTjNCdLKfmRM32E9MkJvDJqiarrA4qTHjPXmBGnfFqB1BF3Majf8DXKEbcLZkmlMUMzt69SW-akedCkYQecXuVGJMhRMCKrL0vUEw7QMOo4u8tjJlo2DDeMuNX31MqcnnhCjfLHBYZ5qyEfjpD4pwqBEhP8BEUGuOtjAqXkE5T9LD7IiZbV-xPziwATmELYG1w9cXtgD6A1UpOv67dYza775PhjQueWZFKHqnJJeGCSaSCtDZ2xuipViJJMBHJBhVqxq0HEIcK74NGQOIrwSZEq6qXTQmzLe_ykrc9rslH31Hp3xDxbwJbNPMi7WiK1a658pPuQM13sSVqA0r_ijXFoeIedWQDdT17SS5aVNG3t1_CsTL-DPwZp2O0b-QPjXQqr-60MK3YJJOhHw5ZPFmEgVmZHn5xuB3jNonK9foST0nmwbVskU4SBz5ZQabhPb57N0aEzb5Vm5hUzei48oHPcIUj8VSxCX7sqmrqbtTSaNuIB7HdoPbIewH4ww4XmRTvx-x68eIMTbAdx6l1JfUtP5rhnGU0cOlWccgaZ7VhmvNpuSuQKOXh5_T5-EqNLVd6sN6aMCIYt1n0fTMYVCRGf8_0qHrPWa9-xOA43IHzVgxTzeePyZVLMPqLa2Wgd0SI9cxkY42ij0k-f8Sr60KSPohqvtDfjMhEV9tpy4UQ1nwLeGgQAJlasGtchdOkr0QIqU3ZxqtDgb03BrXKihSnGGyui9V-1FMLeZqcf-lYArH4FD-3LrVmbL1DZLKX0SwhMSQqxzyEFlz8JG78eCkO38itp6ew8vx5iKBzI6WZi_Yz0_RMjswD5uNyVTOi7fVHGnvGJ3ALeaRRx8zX3UzHfcM1-PgxBTCm8khcJn-4RFUIXeFHNrg5vaXKBnDvz3U2jxHkKzE3aZGJVCBVclYQy4qHuolRom46n7ur3WA00hRpBCfepRuFS9Vw3uJzECwmUFD9AVH3PTYTPxRUy2HhC55D_mBdAlu3nbnBxFBwltDBF-2YMGdN3T6Ct28qajygQg7dS_We6vU4Su5tC1lxMpoNZBI_MA2QuOTHMy_SBcv9-s0eTqIpu1uRzVD7lrQKvUpGx_O3nMF5R3lel3GzcccmrqRxYbtNBE1368t1aN0DJMzbGe_KGab2KLay-8X65sqw5nkhiSO3Z7A7DR3kVIeUTaLMqbwmT2KX9GnzjvSGxwBxk6mTaZqZk5GH254CgcjPe399bju-sNnK2Y8HScAeonuiyeQbWP-g1zYWu8cRzkEG7gl_ZnVm2Y3DO5g9Vz01dLsOVqmBJtI_HXO1c5hdeUfuOlp7boa2kXyKoPyqytnSLzyO2E11KHbBFUadB67aekMAwclPbbeOejLQjkS_sRcSOpAF65Tu_v2sdf-4Wrw1DLIlJJ42-ntI6BZayzn74AzqnuIPJNTgREBXiZTCJ9aDW2d-F17s5bV-2aRJ9vId15I4lKA_XzDYmzvMWKlUNu3aXykAmbGXsHnvznInw7aNTgLYrpAKQGIpf3sqNRbJ8km2jx9A4AuYfdE9Vr7CxqrzhyxrkcdSyyapS62YIJ578Ctn7FgmLZtmqZZZdLqDGikBvrgTr8jd8foBaUUTvGNOJuhcbQq5z0iAgQYpEXO1FGSPp8_3uxPJGwre0tyTJQbveHOVNsmOTLkBYqT6WtbSWW2aZOXgWTGDEHOZ7dsyysK-K2qcg1XpcnEbFnjuuhoy2dmamMJt1WFwHYxDL_0scV8-_SV6AGOiMB8Q7ysajHE6wYQoPm5jVJ-C3ng20valEQB0nnd6r3O78leZaxrDFoV2Y6Gpp-LPX39-vlqOWSuf35wSMFHtma2hEJJyMseWBSoIExjHXJYXniE8RqZNIAiaadYgVRjeuc2wfcamjlsFMjXETReAN3Bl-umsJkWklQQFQi5e4AVvOHBHrOlsSmePzYjrTXvZEEkdmO69fmE_hhjvXSUkzzs6ySN_c49-tm8I_1rnmx_irL9tyBChUf64uTYWb0jxfdqzgws1UVDABH8JnJurQXu1dDwjBHiqn3P21d70isnZjaGgS3YNxF1hGfPc4f3NwJdYN_8Zrn3x15aq5W1XPiE8KTys631OwVCOiG-MUscHNLGyGgPJQj7uCTZf7550oytWifSp9eXxmxeA9FTIx9anxyGHI0Y7e16ohLn--edfmZ-lKTcl-Kk8OPV3M0kCmdHvOQmnnXA_D_7_ym3rKT3OrfydJX7I5OpwJIZaOnU8nTQcgx6hgUX2K8c60T870wFL1hqZeAO2fHuNZmebLASLhJSzh0iLOGeIyE-Y2CQNrI8HYuio63S5oKHiq3ltIRk4mEn5sUNkzIaKXYgUa9oI5joRXOiA2n3Q3ecyD_acSvf91fefj1AA-qCoBXZ0KpIBPAHLDulLyuGXemOUxot3Pn0pbUdYFrkyT-3gUaOGjDXuHl_gnxFJKV0E1KfrHW9Wuoo4yh8l3mxnRRnQVXZzEADIHqHGVnIGbruBgOrxxegJeXcv-8qP_QGyqI7kX75Z9_abkT6AnFxEx8QmdpwcjoD-6bLfEhkyQGmLrhVrU8e2fRGdn8z__R8IlP1eQgwAAA==.eyJjbHVzdGVyVXJsIjoiaHR0cHM6Ly9XQUJJLVVTLUVBU1QyLUItUFJJTUFSWS1yZWRpcmVjdC5hbmFseXNpcy53aW5kb3dzLm5ldCIsImVtYmVkRmVhdHVyZXMiOnsibW9kZXJuRW1iZWQiOmZhbHNlfX0=";

    // Get models object to access enums for embed configuration
    var models = window['powerbi-client'].models;

    var config = {
      type: 'report',
      id: embedReportId,
      embedUrl: embedUrl,
      accessToken: accessToken,
      tokenType: models.TokenType.Embed,
    };

    // Get a reference to the embedded report HTML element
    var reportContainer = document.getElementById('embedContainer');

    // call load() instead of embed() to load the report while delaying the rendering process
    var report = powerbi.load(embedContainer, config);

    // when loaded event occurs, set current page then call render()
    report.on("loaded", async function () {

      $("#loading").hide();
      $("#embedContainer").show();

      // Call report.render() to display report
      report.render(config);
    });


    // code to resize the reportContainer to the size of the hosting browser window.
    $(function () {
      var widthBuffer = 12;
      var heightBuffer = 12;
      $("#embedContainer").height($(window).height() - (heightBuffer));
      $("#embedContainer").width($(window).width() - widthBuffer);
      $(window).resize(function () {
        $("#embedContainer").height($(window).height() - (heightBuffer));
        $("#embedContainer").width($(window).width() - widthBuffer);
      });
    });

  </script>

</body>
</html>